p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.75,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xntercept=mean(m1$Tpot[m1$TPM>=quantile(m_i$TPM,.99,na.rm=T)]),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m1$Tpot[m1$TPM>=quantile(m_i$TPM,.99,na.rm=T)]),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
mean(m1$Tpot[m1$TPM>=quantile(m_i$TPM,.99,na.rm=T)])
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m1$Tpot[m1$TPM>=quantile(m_i$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m1$Tpot[m1$TPM>=quantile(m1$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m2$Tpot[m2$TPM>=quantile(m2$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m3$Tpot[m3$TPM>=quantile(m3$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)+
geom_vline(xintercept=mean(m4$Tpot[m4$TPM>=quantile(m4$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
mean(m4$Tpot[m4$TPM>=quantile(m4$TPM,.99,na.rm=T)],na.rm=T)
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m1$Tpot[m1$TPM>=quantile(m1$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m2$Tpot[m2$TPM>=quantile(m2$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m3$Tpot[m3$TPM>=quantile(m3$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,0.99,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m4$Tpot[m4$TPM>=quantile(m4$TPM,.99,na.rm=T)],na.rm=T),
color="red",lty=2)
ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
library(dplyr)
library(reshape2)
library(ggplot2)
library(ggpubr)
plotQuantiles <- function(m1,m2,m3,m4,q_thresh){
p1 <- ggplot(m1,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,q_thresh,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m1$Tpot[m1$TPM>=quantile(m1$TPM,q_thresh,na.rm=T)],na.rm=T),
color="red",lty=2)
p2 <- ggplot(m2,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,q_thresh,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m2$Tpot[m2$TPM>=quantile(m2$TPM,q_thresh,na.rm=T)],na.rm=T),
color="red",lty=2)
p3 <- ggplot(m3,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,q_thresh,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m3$Tpot[m3$TPM>=quantile(m3$TPM,q_thresh,na.rm=T)],na.rm=T),
color="red",lty=2)
p4 <- ggplot(m4,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,q_thresh,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none")+
geom_vline(xintercept=mean(m4$Tpot[m4$TPM>=quantile(m4$TPM,q_thresh,na.rm=T)],na.rm=T),
color="red",lty=2)
p <- ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
return(p)
}
setwd("~/eukgrowth/Data/")
x <- read.csv("TOPAZ_MAG_abundance.csv")
m1 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E001")
m2 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E003")
m3 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E004")
m4 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E005")
plotQuantiles(m1,m2,m3,m4,0.99)
plotQuantiles(m1,m2,m3,m4,0.90)
plotQuantiles(m1,m2,m3,m4,0.75)
sum(m1$TPM>quantile(m1$TPM,0.9,na.rm=T),na.rm=T)
sum(m2$TPM>quantile(m2$TPM,0.9,na.rm=T),na.rm=T)
sum(m3$TPM>quantile(m3$TPM,0.9,na.rm=T),na.rm=T)
sum(m4$TPM>quantile(m4$TPM,0.9,na.rm=T),na.rm=T)
head(x)
head(x,n=10)
tail(x)
plotQuantiles(m5,m6,m7,m8,0.99)
m5 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E094")
m6 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E012")
m7 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E014")
m8 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E017")
plotQuantiles(m1,m2,m3,m4,0.99)
plotQuantiles(m1,m2,m3,m4,0.90)
plotQuantiles(m1,m2,m3,m4,0.75)
plotQuantiles(m5,m6,m7,m8,0.99)
m5 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E094")
m6 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E012")
m7 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E014")
m8 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E017")
plotQuantiles(m5,m6,m7,m8,0.99)
plotQuantiles(m5,m6,m7,m8,0.90)
plotQuantiles(m5,m6,m7,m8,0.75)
plotQuantiles(m5,m6,m7,m8,0.99)
plotQuantiles(m5,m6,m7,m8,0.90)
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.99)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.99)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.90)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.99)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q90.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.90)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q75.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.75)
dev.off()
x
x[100:106,]
m8 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E017")
m9 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E018")
m10 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E020")
m11 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E021")
m12 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E023")
plotQuantiles(m9,m10,m11,m12,0.99)
plotQuantiles(m9,m10,m11,m12,0.90)
plotQuantiles(m9,m10,m11,m12,0.75)
sum(m1$TPM>quantile(m1$TPM,0.99,na.rm=T),na.rm=T)
sum(m2$TPM>quantile(m2$TPM,0.99,na.rm=T),na.rm=T)
sum(m3$TPM>quantile(m3$TPM,0.99,na.rm=T),na.rm=T)
sum(m4$TPM>quantile(m4$TPM,0.99,na.rm=T),na.rm=T)
mags <- x$new_mag_name %>% unique()
mag_quant <- data.frame(mag=character(),
q75=numeric(),
q75Tpot=numeric(),
q90=numeric(),
q90Tpot=numeric(),
q99=numeric(),
q99Tpot=numeric())
for(i in 1:length(mags)){
m_i <- x %>% subset(new_mag_name==mags[i])
mag_quant <- rbind(mag_quant,
data.frame(mag=mags[i],
q75=quantile(m_i$TPM,0.75,na.rm=T),
q75Tpot=m_i$Tpot[m_i$TPM>=quantile(m_i$TPM,.75,na.rm=T)] %>%
mean(na.rm=T),
q90=quantile(m_i$TPM,0.90,na.rm=T),
q90Tpot=m_i$Tpot[m_i$TPM>=quantile(m_i$TPM,.90,na.rm=T)] %>%
mean(na.rm=T),
q99=quantile(m_i$TPM,0.99,na.rm=T),
q99Tpot=m_i$Tpot[m_i$TPM>=quantile(m_i$TPM,.99,na.rm=T)] %>%
mean(na.rm=T)))
}
p1 <- ggplot(mag_quant,aes(x=q75,y=q99)) +
geom_point() +
scale_y_log10() +
scale_x_log10() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("TPM q75") +
ylab("TPM q99")
p2 <- ggplot(mag_quant,aes(x=q75Tpot,y=q99Tpot)) +
geom_point() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean Temp of Samples in TPM q75") +
ylab("Mean Temp of Samples in TPM q99") +
geom_abline(slope=1,intercept=0,lty=2)
pdf("q99_vs_q75.pdf",width=8,height=4)
ggarrange(p1,p2,ncol=2)
dev.off()
p1 <- ggplot(mag_quant,aes(x=q90,y=q99)) +
geom_point() +
scale_y_log10() +
scale_x_log10() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("TPM q90") +
ylab("TPM q99")
p2 <- ggplot(mag_quant,aes(x=q90Tpot,y=q99Tpot)) +
geom_point() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean Temp of Samples in TPM q90") +
ylab("Mean Temp of Samples in TPM q99") +
geom_abline(slope=1,intercept=0,lty=2)
pdf("q99_vs_q90.pdf",width=8,height=4)
ggarrange(p1,p2,ncol=2)
dev.0ff()
dev.off()
p1 <- ggplot(mag_quant,aes(x=q75,y=q99)) +
geom_point() +
scale_y_log10() +
scale_x_log10() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean TPM q75") +
ylab("Mean TPM q99")
p2 <- ggplot(mag_quant,aes(x=q75Tpot,y=q99Tpot)) +
geom_point() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean Temp of Samples in TPM q75") +
ylab("Mean Temp of Samples in TPM q99") +
geom_abline(slope=1,intercept=0,lty=2)
pdf("q99_vs_q75.pdf",width=8,height=4)
ggarrange(p1,p2,ncol=2)
dev.off()
p1 <- ggplot(mag_quant,aes(x=q90,y=q99)) +
geom_point() +
scale_y_log10() +
scale_x_log10() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean TPM q90") +
ylab("Mean TPM q99")
p2 <- ggplot(mag_quant,aes(x=q90Tpot,y=q99Tpot)) +
geom_point() +
geom_smooth(method="lm") +
theme_pubclean() +
xlab("Mean Temp of Samples in TPM q90") +
ylab("Mean Temp of Samples in TPM q99") +
geom_abline(slope=1,intercept=0,lty=2)
pdf("q99_vs_q90.pdf",width=8,height=4)
ggarrange(p1,p2,ncol=2)
dev.off()
ggplot(m1,aes(x=TPM)) +
geom_density()
ggplot(m1,aes(x=TPM)) +
geom_density() +
theme_publcean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
scale_x_log10() +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_abline(xintercept=quantiles(m1,0.99,na.rm=T),lty=2)
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_abline(xintercept=quantile(m1,0.99,na.rm=T),lty=2) +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_abline(xintercept=quantile(m1$TPM,0.99,na.rm=T),lty=2) +
theme_pubclean()
quantile(m1$TPM,0.99,na.rm=T)
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_vline(xintercept=quantile(m1$TPM,0.99,na.rm=T),lty=2) +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_vline(xintercept=quantile(m1$TPM,0.99,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.90,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.75,na.rm=T),lty=2) +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
scale_x_log10() +
geom_vline(xintercept=quantile(m1$TPM,0.99,na.rm=T)%>%log10(),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.90,na.rm=T)%>%log10(),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.75,na.rm=T)%>%log10(),lty=2) +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
scale_x_log10() +
geom_vline(xintercept=quantile(m1$TPM%>%log10(),0.99,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM%>%log10(),0.90,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM%>%log10(),0.75,na.rm=T),lty=2) +
theme_pubclean()
quantile(m1$TPM%>%log10(),0.99,na.rm=T)
ggplot(m1,aes(x=TPM)) +
geom_density() +
scale_x_log10() +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.99,na.rm=T),lty=2) +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.90,na.rm=T),lty=2) +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.75,na.rm=T),lty=2) +
theme_pubclean()
ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_vline(xintercept=quantile(m1$TPM,0.99,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.90,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.75,na.rm=T),lty=2) +
theme_pubclean()
library(dplyr)
library(reshape2)
library(ggplot2)
library(ggpubr)
pq <- function(m,q_thresh){
p <- ggplot(m,aes(x=Tpot,y=TPM,color=TPM>quantile(TPM,q_thresh,na.rm=T))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m$Tpot[m$TPM>=quantile(m$TPM,q_thresh,na.rm=T)],na.rm=T),
color="red",lty=2)
return(p)
}
pqlog <- function(m,q_thresh){
p <- ggplot(m,aes(x=Tpot,y=TPM,color=TPM>(10^quantile(log10(TPM),q_thresh,na.rm=T)))) +
geom_point() +
theme_pubclean() +
scale_color_manual(values=c("black","red")) +
theme(legend.position = "none") +
geom_vline(xintercept=mean(m$Tpot[m$TPM>=(10^quantile(log10(m$TPM),q_thresh,na.rm=T))],na.rm=T),
color="red",lty=2)
return(p)
}
plotQuantiles <- function(m1,m2,m3,m4,q_thresh,logq=F){
if(logq==F){
p1 <- pq(m1,q_thresh)
p2 <- pq(m2,q_thresh)
p3 <- pq(m3,q_thresh)
p4 <- pq(m4,q_thresh)
} else {
p1 <- pqlog(m1,q_thresh)
p2 <- pqlog(m2,q_thresh)
p3 <- pqlog(m3,q_thresh)
p4 <- pqlog(m4,q_thresh)
}
p <- ggarrange(p1,p2,p3,p4,nrow=2,ncol=2)
return(p)
}
setwd("~/eukgrowth/Data/")
x <- read.csv("TOPAZ_MAG_abundance.csv")
m1 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E001")
m2 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E003")
m3 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E004")
m4 <- x %>% subset(new_mag_name=="TOPAZ_IOD1_E005")
m5 <- x %>% subset(new_mag_name=="TOPAZ_SPS3_E094")
m6 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E012")
m7 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E014")
m8 <- x %>% subset(new_mag_name=="TOPAZ_SPS2_E017")
m9 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E018")
m10 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E020")
m11 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E021")
m12 <- x %>% subset(new_mag_name=="TOPAZ_MSS1_E023")
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.99)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q90.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.90)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q75.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.75)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q99_log10.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.99,logq=T)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q90_log10.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.90,logq=T)
dev.off()
setwd("~/eukgrowth/Figs/")
pdf("example_quantiles_q75_log10.pdf",height = 8,width=8)
plotQuantiles(m1,m2,m3,m4,0.75,logq=T)
dev.off()
p1 <- ggplot(m1,aes(x=TPM)) +
geom_density() +
geom_vline(xintercept=quantile(m1$TPM,0.99,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.90,na.rm=T),lty=2) +
geom_vline(xintercept=quantile(m1$TPM,0.75,na.rm=T),lty=2) +
theme_pubclean()
p2 <- ggplot(m1,aes(x=TPM)) +
geom_density() +
scale_x_log10() +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.99,na.rm=T),lty=2) +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.90,na.rm=T),lty=2) +
geom_vline(xintercept=10^quantile(m1$TPM%>%log10(),0.75,na.rm=T),lty=2) +
theme_pubclean()
pdf("quants_lognolog.pdf",width=8,hright=4)
ggarrange(p1.p2,nrow=2)
dev.off()
sum(log10(m1$TPM)>log10(quantile(m1$TPM,0.75,na.rm=T)),na.rm=T)
sum((m1$TPM)>10^log10(quantile(m1$TPM,0.75,na.rm=T)),na.rm=T)
sample(1:1000,250)
intersect(sample(1:1000,250),sample(1:1000,250))
n <- 1000
overlap75 <- numeric(n)
for(i in 1:n){
overlap75[i] <- length(intersect(sample(1:1000,250),sample(1:1000,250)))
}
hist(overlap75)
abline(v=mean(overlap75),lty=2)
pdf("q75_overlap.pdf",width=4,height=4)
hist(overlap75,xlab="Number of Shared Samples Between Two Random Draws of 250 from 1000")
abline(v=mean(overlap75),lty=2)
dev.off()
pdf("q75_overlap.pdf",width=6,height=4)
hist(overlap75,xlab="Number of Shared Samples Between Two Random Draws of 250 from 1000",main="")
abline(v=mean(overlap75),lty=2)
dev.off()
